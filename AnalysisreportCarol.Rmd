---
title: "Group2 Report"
author: "Carol Kamya"
date: "9/15/2022"
output: html_document
---

```{r setup, include=FALSE}
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r echo=FALSE}
library(tidyverse)
library(here)
library(ggcorrplot)
library(patchwork)
library(ggplot2)
read_delim(here("groupproject", "exam_nontidy.txt"))
data<-read_delim (here("groupproject", "exam_nontidy.txt")))

#Day 6 
##Stratify your data by a categorical column and report min, max, mean and sd of a numeric column for a defined set of observations
##Only for persons with T.Stage == 1
tstagedistribution<- data %>% 
  filter(t_stage ==1) %>% 
  group_by(Recurrence) %>% 
  summarise(max(age, na.rm = T),
            min(age, na.rm = T),
            mean(age, na.rm = T), 
            sd(age, na.rm = T))
tstagedistribution

##Only for persons with Median.RBC.Age == 25
medianrbcage <- data %>% 
  filter (Median.RBC.Age == 25) %>% 
  group_by(Recurrence) %>% 
  summarise(max(age, na.rm = T),
            min(age, na.rm = T),
            mean(age, na.rm = T), 
            sd(age, na.rm = T))
medianrbcage

## Only for persons with TimeToReccurence later than 4 days
timetorecurrence <-data %>% 
  filter(TimeToRecurrence > 4) %>% 
  group_by(Recurrence) %>% 
  summarise(max(age, na.rm = T),
            min(age, na.rm = T),
            mean(age, na.rm = T), 
            sd(age, na.rm = T)) 

timetorecurrence

##Only for persons recruited in Hosp1 and Tvol == 2
onlyhosp1_tvol <- data %>% 
  filter(Hospitalname == "Hosp1", TVol==2) %>% 
  group_by(Recurrence) %>% 
  summarise(max(age, na.rm = T),
            min(age, na.rm = T),
            mean(age, na.rm = T), 
            sd(age, na.rm = T)) 
onlyhosp1_tvol

##Use two categorical columns in your dataset to create a table 
 data3 %>% 
   count(Recurrence,pvol_binary)



```

## Including Plots

You can also embed plots, for example:

```{r , echo=FALSE}
#Does the distribution of PVol depend on sGS?
data3 %>% 
  ggplot(aes(x = PVol, y = sGS)) +
  geom_point()

#Did having AdjRadTherapy affected time to recurrence?
#Boxplot showing AdjRadtheory vs recurrence
  Anyadjtherapy_recurrence <-data3 %>%
    filter(!is.na(TimeToRecurrence_days)) %>%
    ggplot(data, mapping = aes(x=as.factor(AdjRadTherapy), y=TimeToRecurrence_days))+
    geom_boxplot(mapping = NULL, stat = "boxplot", position ="dodge2")
  
  Anyadjtherapy_recurrence 
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
